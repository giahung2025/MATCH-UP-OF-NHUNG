<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tr√≤ ch∆°i T√¨m Ch·ªØ C√°i</title>
    <!-- Favicon cho GitHub Pages -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß©</text></svg>">
    
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Arial Rounded MT Bold', cursive;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        body {
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            min-height: -webkit-fill-available;
            padding: 0;
            color: #333;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            touch-action: pan-y;
        }
        
        /* Background v·ªõi h√¨nh ·∫£nh vui nh·ªôn */
        .background-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://img.freepik.com/free-vector/cute-animals-seamless-pattern_42750-613.jpg');
            background-size: 200px;
            background-position: center;
            opacity: 0.1;
            z-index: -1;
            pointer-events: none;
        }
        
        .container {
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            background: linear-gradient(145deg, #ffffff, #f0f9ff);
            border-radius: 0;
            box-shadow: 0 0 0 4px #ffd166;
            padding: 1%;
            z-index: 1;
            position: relative;
            border: 4px solid white;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* Header - c·ª±c g·ªçn */
        .header {
            text-align: center;
            flex-shrink: 0;
            height: 12%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0.5% 0;
        }
        
        h1 {
            color: #ff6b6b;
            font-size: min(4vw, 4vh, 2rem);
            margin: 0;
            text-shadow: 2px 2px 0px rgba(255, 107, 107, 0.2),
                         3px 3px 0px rgba(255, 209, 102, 0.2);
            letter-spacing: 0.5px;
            background: linear-gradient(45deg, #ff6b6b, #ff8a00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }
        
        .title-icon {
            font-size: min(3vw, 3vh, 1.5rem);
            display: block;
            margin-bottom: 0.2%;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        
        .subtitle {
            color: #4a90e2;
            font-size: min(2.5vw, 2.5vh, 1.2rem);
            margin: 0;
            font-weight: bold;
            background: linear-gradient(45deg, #4a90e2, #06d6a0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }
        
        .instructions {
            background: linear-gradient(145deg, #e8f4ff, #d4eaff);
            padding: 0.5% 1%;
            border-radius: 5px;
            font-size: min(2vw, 2vh, 1rem);
            color: #4a90e2;
            text-align: center;
            border: 2px solid #4a90e2;
            position: relative;
            flex-shrink: 0;
            line-height: 1;
            height: 6%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0.5% 0;
        }
        
        .instructions::before {
            content: 'üí°';
            position: absolute;
            left: 1%;
            font-size: min(2vw, 2vh, 1rem);
        }
        
        /* GAME AREA - LU√îN 2 C·ªòT D·ªåC */
        .game-area {
            display: flex;
            flex-direction: row;
            gap: 1%;
            flex: 1;
            min-height: 0;
            overflow: hidden;
            height: 55%;
        }
        
        /* Ph·∫ßn c√¢u h·ªèi b√™n tr√°i - LU√îN 3 H√ÄNG NGANG */
        .questions-section {
            flex: 3;
            display: flex;
            flex-direction: column;
            gap: 1%;
            min-width: 0;
            overflow: hidden;
            justify-content: space-between;
        }
        
        /* M·ªói c√¢u h·ªèi - chi·ªÅu cao ƒë·ªÅu nhau */
        .question-item {
            display: flex;
            align-items: center;
            background: linear-gradient(145deg, #ffffff, #e8f4ff);
            border: 2px solid #a0d0ff;
            border-radius: 8px;
            padding: 1%;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            box-shadow: 0 3px 8px rgba(160, 208, 255, 0.3);
            height: 32%; /* 3 h√†ng ƒë·ªÅu nhau */
            flex-shrink: 0;
        }
        
        .question-item.drag-over {
            background: linear-gradient(145deg, #e8f4ff, #d4eaff);
            border-color: #4a90e2;
            box-shadow: 0 4px 10px rgba(74, 144, 226, 0.4);
            transform: translateY(-1px);
        }
        
        .question-item.correct {
            border-color: #06d6a0;
            background: linear-gradient(145deg, #c1ffd7, #a8f5cb);
        }
        
        .question-item.incorrect {
            border-color: #ef476f;
            background: linear-gradient(145deg, #ffc9d5, #ffb5c8);
        }
        
        /* Ph·∫ßn h√¨nh ·∫£nh trong c√¢u h·ªèi */
        .question-image {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5%;
            margin-right: 2%;
            width: 20%;
        }
        
        .image-container {
            width: 100%;
            aspect-ratio: 1/1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 6px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            border: 2px solid white;
            position: relative;
        }
        
        .image-container::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #ff6b6b, #ffd166, #06d6a0, #4a90e2);
            border-radius: 8px;
            z-index: -1;
        }
        
        .image-container img {
            width: 85%;
            height: 85%;
            object-fit: contain;
            transition: transform 0.3s;
        }
        
        .image-label {
            font-size: min(1.5vw, 1.5vh, 0.8rem);
            color: #4a90e2;
            font-weight: bold;
            text-align: center;
            line-height: 1;
        }
        
        /* Ph·∫ßn t·ª´ g·ª£i √Ω trong c√¢u h·ªèi */
        .question-text {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 2%;
            min-width: 0;
        }
        
        .question {
            font-size: min(3.5vw, 3.5vh, 2rem);
            color: #333;
            font-weight: bold;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
            margin-bottom: 2%;
            word-break: break-word;
            line-height: 1;
        }
        
        .question-hint {
            font-size: min(1.5vw, 1.5vh, 0.8rem);
            color: #ff6b6b;
            font-weight: bold;
            line-height: 1;
        }
        
        /* √î tr·ªëng trong c√¢u h·ªèi */
        .answer-slot-container {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5%;
            margin-left: 2%;
            width: 15%;
        }
        
        .answer-label {
            font-size: min(1.5vw, 1.5vh, 0.8rem);
            color: #4a90e2;
            font-weight: bold;
            text-align: center;
            line-height: 1;
        }
        
        .answer-slot {
            width: 100%;
            aspect-ratio: 1/1;
            border-radius: 6px;
            background: linear-gradient(145deg, #e8f4ff, #d4eaff);
            border: 1.5px solid #4a90e2;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: min(3.5vw, 3.5vh, 2rem);
            font-weight: bold;
            color: #4a90e2;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: inset 0 0 5px rgba(74, 144, 226, 0.2);
        }
        
        .answer-slot.filled {
            background: linear-gradient(145deg, #c8e6ff, #a8d4ff);
            transform: scale(1.05);
            box-shadow: 0 2px 6px rgba(74, 144, 226, 0.4);
        }
        
        /* Ph·∫ßn keywords b√™n ph·∫£i - LU√îN 2 C·ªòT D·ªåC */
        .keywords-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: linear-gradient(145deg, #fff9e6, #fff0cc);
            padding: 2%;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(255, 209, 102, 0.3),
                        inset 0 0 0 2px #ffd166;
            border: 2px solid white;
            min-width: 0;
            max-width: 25%;
            justify-content: space-between;
        }
        
        .keywords-title {
            text-align: center;
            font-size: min(2.2vw, 2.2vh, 1.2rem);
            color: #ff8a00;
            margin: 0;
            font-weight: bold;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
            background: linear-gradient(45deg, #ff8a00, #ff6b6b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }
        
        /* C√°c keyword - TH·ª® T·ª∞: T > C > I */
        .keywords-grid {
            display: flex;
            flex-direction: column;
            gap: 5%;
            flex: 1;
            justify-content: space-around;
        }
        
        .keyword-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5%;
            padding: 3% 0;
            background: linear-gradient(145deg, #ffffff, #fff9e6);
            border-radius: 6px;
            border: 1.5px solid #ffd166;
            flex: 1;
            justify-content: center;
        }
        
        .keyword-label {
            font-size: min(1.5vw, 1.5vh, 0.8rem);
            color: #ff8a00;
            font-weight: bold;
            text-align: center;
            line-height: 1;
        }
        
        .keyword-slot {
            width: min(8vw, 8vh, 50px);
            height: min(8vw, 8vh, 50px);
            border-radius: 6px;
            background: linear-gradient(145deg, #ffd166, #ffc145);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: min(3.5vw, 3.5vh, 2rem);
            font-weight: bold;
            color: #333;
            cursor: grab;
            box-shadow: 0 3px 8px rgba(255, 209, 102, 0.4),
                        0 0 0 2px white;
            user-select: none;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            touch-action: none;
            z-index: 1000;
        }
        
        .keyword-slot::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #ff6b6b, #ffd166, #06d6a0, #4a90e2);
            border-radius: 8px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .keyword-slot:hover::before,
        .keyword-slot.dragging::before {
            opacity: 1;
        }
        
        .keyword-slot:hover {
            transform: translateY(-2px) rotate(2deg);
            box-shadow: 0 5px 10px rgba(255, 209, 102, 0.6),
                        0 0 0 2px white;
        }
        
        .keyword-slot:active {
            cursor: grabbing;
            transform: scale(0.95);
        }
        
        .keyword-slot.dragging {
            opacity: 0.9;
            box-shadow: 0 8px 15px rgba(255, 209, 102, 0.7);
            z-index: 10000;
        }
        
        .keyword-slot.used {
            opacity: 0.3;
            cursor: default;
            transform: none;
            box-shadow: 0 2px 4px rgba(255, 209, 102, 0.2);
        }
        
        .keyword-slot.used::before {
            opacity: 0;
        }
        
        /* Ph·∫ßn d∆∞·ªõi c√πng - Controls */
        .bottom-section {
            flex-shrink: 0;
            height: 25%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding-top: 1%;
        }
        
        .feedback {
            text-align: center;
            min-height: 20%;
            font-size: min(2vw, 2vh, 1rem);
            font-weight: bold;
            padding: 1% 2%;
            border-radius: 6px;
            transition: all 0.3s;
            border: 1.5px solid transparent;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1%;
        }
        
        .correct {
            color: #06a76a;
            background: linear-gradient(145deg, #c1ffd7, #a8f5cb);
            border-color: #06d6a0;
            animation: correctPulse 2s infinite;
        }
        
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.01); }
        }
        
        .incorrect {
            color: #ef476f;
            background: linear-gradient(145deg, #ffc9d5, #ffb5c8);
            border-color: #ef476f;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 2%;
            flex-wrap: nowrap;
            height: 30%;
        }
        
        button {
            padding: 0;
            font-size: min(2vw, 2vh, 1rem);
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            flex: 1;
            max-width: 45%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        button::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg);
            transition: all 0.5s;
        }
        
        button:hover::after {
            left: 50%;
        }
        
        #check-btn {
            background: linear-gradient(145deg, #4a90e2, #3a7bc8);
            color: white;
        }
        
        #check-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 12px rgba(74, 144, 226, 0.5);
        }
        
        #reset-btn {
            background: linear-gradient(145deg, #ff9a76, #ff8a66);
            color: white;
        }
        
        #reset-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 12px rgba(255, 154, 118, 0.5);
        }
        
        .timer-audio-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 2%;
            height: 30%;
        }
        
        .timer {
            flex: 2;
            text-align: center;
            font-size: min(1.8vw, 1.8vh, 0.9rem);
            color: #666;
            font-weight: bold;
            background: linear-gradient(145deg, #ffffff, #f0f9ff);
            padding: 1% 2%;
            border-radius: 6px;
            border: 1.5px solid #ffd166;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
        }
        
        .timer span {
            color: #ff6b6b;
            font-size: min(2.2vw, 2.2vh, 1.2rem);
            text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
            margin-left: 1%;
        }
        
        .audio-controls {
            flex: 1;
            display: flex;
            justify-content: center;
            height: 100%;
        }
        
        .audio-btn {
            padding: 0;
            font-size: min(1.6vw, 1.6vh, 0.8rem);
            background: linear-gradient(145deg, #9d4edd, #8a2be2);
            color: white;
            border-radius: 15px;
            border: none;
            cursor: pointer;
            box-shadow: 0 3px 6px rgba(157, 78, 221, 0.3);
            transition: all 0.3s;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .audio-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(157, 78, 221, 0.4);
        }
        
        /* Th√™m hi·ªáu ·ª©ng cho ch·ªØ c√°i khi k√©o */
        .drag-ghost {
            position: fixed;
            width: min(8vw, 8vh, 50px);
            height: min(8vw, 8vh, 50px);
            border-radius: 6px;
            background: linear-gradient(145deg, #ffd166, #ffc145);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: min(3.5vw, 3.5vh, 2rem);
            font-weight: bold;
            color: #333;
            pointer-events: none;
            z-index: 10000;
            box-shadow: 0 8px 15px rgba(255, 209, 102, 0.7);
            transform: translate(-50%, -50%);
            opacity: 0.95;
            transition: transform 0.1s;
        }
        
        /* ƒê·∫¢M B·∫¢O LU√îN L√Ä 2 C·ªòT D·ªåC V√Ä 3 H√ÄNG NGANG */
        @media (orientation: portrait) {
            /* Portrait v·∫´n gi·ªØ 2 c·ªôt d·ªçc */
            .container {
                padding: 2%;
            }
            
            .game-area {
                height: 50%;
            }
            
            .questions-section {
                flex: 2;
            }
            
            .keywords-section {
                max-width: 30%;
            }
            
            .question {
                font-size: min(4vw, 4vh, 2rem);
            }
            
            .answer-slot, .keyword-slot {
                font-size: min(4vw, 4vh, 2rem);
            }
            
            .drag-ghost {
                font-size: min(4vw, 4vh, 2rem);
            }
        }
        
        /* Cho m√†n h√¨nh r·∫•t nh·ªè */
        @media (max-height: 500px) {
            .header {
                height: 10%;
            }
            
            .instructions {
                height: 5%;
                font-size: min(1.5vw, 1.5vh, 0.7rem);
            }
            
            .game-area {
                height: 50%;
            }
            
            .bottom-section {
                height: 30%;
            }
            
            h1 {
                font-size: min(3vw, 3vh, 1.5rem);
            }
            
            .question {
                font-size: min(3vw, 3vh, 1.5rem);
            }
        }
        
        /* Cho m√†n h√¨nh r·∫•t r·ªông */
        @media (min-width: 1200px) {
            .container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 1% 2%;
            }
        }
    </style>
</head>
<body>
    <!-- Background -->
    <div class="background-image" id="background-image"></div>
    
    <div class="container">
        <div class="header">
            <span class="title-icon">üß©üé®üê•</span>
            <h1>Tr√≤ ch∆°i T√¨m Ch·ªØ C√°i</h1>
            <p class="subtitle">H√£y k√©o ch·ªØ c√°i ƒë√∫ng v√†o m·ªói h√¨nh!</p>
        </div>
        
        <div class="instructions">K√©o c√°c ch·ªØ c√°i b√™n ph·∫£i v√†o √¥ tr·ªëng ph√π h·ª£p v·ªõi m·ªói h√¨nh b√™n tr√°i</div>
        
        <div class="game-area">
            <!-- Ph·∫ßn c√¢u h·ªèi b√™n tr√°i - LU√îN 3 H√ÄNG NGANG -->
            <div class="questions-section">
                <!-- C√¢u h·ªèi 1: Con g√† -->
                <div class="question-item" id="question-1" data-correct="c">
                    <div class="question-image">
                        <div class="image-container">
                            <img src="https://img.tripi.vn/cdn-cgi/image/width=700,height=700/https://gcs.tripi.vn/public-tripi/tripi-feed/img/482881IHi/anh-mo-ta.png" 
                                 alt="Con g√†" 
                                 loading="lazy">
                        </div>
                    </div>
                    
                    <div class="question-text">
                        <div class="question">...on g√†</div>
                        <div class="question-hint">T√¨m ch·ªØ c√°i ph√π h·ª£p</div>
                    </div>
                    
                    <div class="answer-slot-container">
                        <div class="answer-slot" id="answer-1"></div>
                    </div>
                </div>
                
                <!-- C√¢u h·ªèi 2: In m√†u -->
                <div class="question-item" id="question-2" data-correct="i">
                    <div class="question-image">
                        <div class="image-container">
                            <img src="https://vcdn.tikicdn.com/ts/product/cf/03/71/247c65863eb01aa7d33de1e9afe015ed.jpg" 
                                 alt="In m√†u" 
                                 loading="lazy">
                        </div>
                    </div>
                    
                    <div class="question-text">
                        <div class="question">...n m√†u</div>
                        <div class="question-hint">T√¨m ch·ªØ c√°i ph√π h·ª£p</div>
                    </div>
                    
                    <div class="answer-slot-container">
                        <div class="answer-slot" id="answer-2"></div>
                    </div>
                </div>
                
                <!-- C√¢u h·ªèi 3: T√†u h·ªèa -->
                <div class="question-item" id="question-3" data-correct="t">
                    <div class="question-image">
                        <div class="image-container">
                            <img src="https://images2.thanhnien.vn/zoom/686_429/528068263637045248/2023/10/12/anh-chup-man-hinh-2023-10-12-luc-104638-16970824094681144114053-0-0-1062-1699-crop-16970824531081807594221.png" 
                                 alt="T√†u h·ªèa" 
                                 loading="lazy">
                        </div>
                    </div>
                    
                    <div class="question-text">
                        <div class="question">...√†u h·ªèa</div>
                        <div class="question-hint">T√¨m ch·ªØ c√°i ph√π h·ª£p</div>
                    </div>
                    
                    <div class="answer-slot-container">
                        <div class="answer-slot" id="answer-3"></div>
                    </div>
                </div>
            </div>
            
            <!-- Ph·∫ßn keywords b√™n ph·∫£i - LU√îN 2 C·ªòT D·ªåC - TH·ª® T·ª∞: T > C > I -->
            <div class="keywords-section">
                <div class="keywords-title">Ch·ªØ c√°i g·ª£i √Ω</div>
                <div class="keywords-grid">
                    <!-- Keyword 1: T (T√†u h·ªèa) -->
                    <div class="keyword-item">
                        <div class="keyword-slot" id="keyword-3" data-letter="t">T</div>
                    </div>
                    
                    <!-- Keyword 2: C (Con g√†) -->
                    <div class="keyword-item">
                        <div class="keyword-slot" id="keyword-1" data-letter="c">C</div>
                    </div>
                    
                    <!-- Keyword 3: I (In m√†u) -->
                    <div class="keyword-item">
                        <div class="keyword-slot" id="keyword-2" data-letter="i">I</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="bottom-section">
            <div class="feedback" id="feedback"></div>
            
            <div class="controls">
                <button id="check-btn">‚úÖ Ki·ªÉm tra</button>
                <button id="reset-btn">üîÑ L√†m l·∫°i</button>
            </div>
            
            <div class="timer-audio-section">
                <div class="timer">
                    ‚è±Ô∏è Th·ªùi gian: <span id="timer">0.0</span>s
                </div>
                
                <!-- Audio controls -->
                <div class="audio-controls">
                    <button class="audio-btn" id="mute-btn">üîá T·∫Øt nh·∫°c</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hi·ªáu ·ª©ng k√©o theo ng√≥n tay -->
    <div class="drag-ghost" id="drag-ghost" style="display: none;"></div>

    <script>
        // Kh·ªüi t·∫°o c√°c bi·∫øn
        let timer = 0;
        let timerInterval = null;
        let gameCompleted = false;
        let isTimerRunning = true;
        let isMuted = false;
        let draggedItem = null;
        let dragGhostVisible = false;
        
        // C√°c ph·∫ßn t·ª≠ DOM
        const checkBtn = document.getElementById('check-btn');
        const resetBtn = document.getElementById('reset-btn');
        const timerElement = document.getElementById('timer');
        const feedbackElement = document.getElementById('feedback');
        const muteBtn = document.getElementById('mute-btn');
        const dragGhostElement = document.getElementById('drag-ghost');
        
        // Th√™m s·ª± ki·ªán DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM ƒë√£ s·∫µn s√†ng, kh·ªüi t·∫°o tr√≤ ch∆°i...");
            initGame();
        });
        
        // Kh·ªüi t·∫°o tr√≤ ch∆°i
        function initGame() {
            // B·∫Øt ƒë·∫ßu b·ªô ƒë·∫øm th·ªùi gian
            startTimer();
            
            // ·∫®n drag ghost
            dragGhostElement.style.display = 'none';
            
            // Th√™m s·ª± ki·ªán cho c√°c keyword
            const keywordSlots = document.querySelectorAll('.keyword-slot');
            keywordSlots.forEach(keyword => {
                // Th√™m s·ª± ki·ªán k√©o th·∫£ cho desktop
                keyword.addEventListener('dragstart', handleDragStart);
                keyword.addEventListener('dragend', handleDragEnd);
                
                // Th√™m s·ª± ki·ªán touch cho mobile
                keyword.addEventListener('touchstart', handleTouchStart, {passive: false});
                keyword.addEventListener('touchmove', handleTouchMove, {passive: false});
                keyword.addEventListener('touchend', handleTouchEnd);
            });
            
            // Th√™m s·ª± ki·ªán drag v√† drop cho c√°c c√¢u h·ªèi
            const questionItems = document.querySelectorAll('.question-item');
            questionItems.forEach(item => {
                item.addEventListener('dragover', handleDragOver);
                item.addEventListener('dragleave', handleDragLeave);
                item.addEventListener('drop', handleDrop);
                item.setAttribute('aria-dropeffect', 'move');
            });
        }
        
        // B·∫Øt ƒë·∫ßu b·ªô ƒë·∫øm th·ªùi gian
        function startTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            timer = 0;
            isTimerRunning = true;
            
            timerInterval = setInterval(() => {
                if (isTimerRunning) {
                    timer += 0.1;
                    timerElement.textContent = timer.toFixed(1);
                }
            }, 100);
        }
        
        // D·ª´ng b·ªô ƒë·∫øm th·ªùi gian
        function stopTimer() {
            isTimerRunning = false;
        }
        
        // ========== DRAG AND DROP FUNCTIONS ==========
        
        // X·ª≠ l√Ω b·∫Øt ƒë·∫ßu k√©o (desktop)
        function handleDragStart(e) {
            if (gameCompleted) return false;
            
            draggedItem = e.target;
            e.target.classList.add('dragging');
            
            e.dataTransfer.setData('text/plain', e.target.id);
            e.dataTransfer.setData('text/letter', e.target.getAttribute('data-letter'));
            
            // T·∫°o ghost element
            createDragGhost(e.target, e.clientX, e.clientY);
            
            return true;
        }
        
        // X·ª≠ l√Ω k·∫øt th√∫c k√©o (desktop)
        function handleDragEnd(e) {
            if (!draggedItem) return;
            
            draggedItem.classList.remove('dragging');
            hideDragGhost();
            draggedItem = null;
        }
        
        // X·ª≠ l√Ω khi k√©o qua v√πng th·∫£ (desktop)
        function handleDragOver(e) {
            if (gameCompleted) return;
            
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }
        
        // X·ª≠ l√Ω khi r·ªùi kh·ªèi v√πng th·∫£ (desktop)
        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }
        
        // X·ª≠ l√Ω khi th·∫£ (desktop) - LU√îN NH·∫¨N CH·ªÆ C√ÅI
        function handleDrop(e) {
            if (gameCompleted || !draggedItem) return;
            
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            const questionItem = e.currentTarget;
            const answerSlot = questionItem.querySelector('.answer-slot');
            const letter = draggedItem.getAttribute('data-letter');
            
            // LU√îN NH·∫¨N CH·ªÆ C√ÅI (kh√¥ng ki·ªÉm tra ƒë√∫ng/sai ·ªü ƒë√¢y)
            placeLetterInSlot(draggedItem, answerSlot, letter);
            
            hideDragGhost();
            draggedItem.classList.remove('dragging');
            draggedItem = null;
        }
        
        // ========== TOUCH FUNCTIONS ==========
        
        // X·ª≠ l√Ω b·∫Øt ƒë·∫ßu ch·∫°m
        function handleTouchStart(e) {
            if (gameCompleted) {
                e.preventDefault();
                return;
            }
            
            const touch = e.touches[0];
            draggedItem = e.target;
            
            draggedItem.classList.add('dragging');
            
            // T·∫°o ghost element
            createDragGhost(draggedItem, touch.clientX, touch.clientY);
            
            e.preventDefault();
        }
        
        // X·ª≠ l√Ω di chuy·ªÉn ng√≥n tay
        function handleTouchMove(e) {
            if (!draggedItem || !dragGhostVisible) return;
            
            const touch = e.touches[0];
            
            // C·∫≠p nh·∫≠t v·ªã tr√≠ ghost element
            updateDragGhostPosition(touch.clientX, touch.clientY);
            
            // Ki·ªÉm tra xem c√≥ ƒëang k√©o qua v√πng th·∫£ kh√¥ng
            const elementAtTouch = document.elementFromPoint(touch.clientX, touch.clientY);
            let hoveredQuestionItem = null;
            
            if (elementAtTouch) {
                hoveredQuestionItem = elementAtTouch.closest('.question-item');
            }
            
            // C·∫≠p nh·∫≠t tr·∫°ng th√°i cho t·∫•t c·∫£ c√°c c√¢u h·ªèi
            const questionItems = document.querySelectorAll('.question-item');
            questionItems.forEach(item => {
                if (item === hoveredQuestionItem) {
                    item.classList.add('drag-over');
                } else {
                    item.classList.remove('drag-over');
                }
            });
            
            e.preventDefault();
        }
        
        // X·ª≠ l√Ω k·∫øt th√∫c ch·∫°m - LU√îN NH·∫¨N CH·ªÆ C√ÅI
        function handleTouchEnd(e) {
            if (!draggedItem) return;
            
            const touch = e.changedTouches[0];
            const elementAtTouch = document.elementFromPoint(touch.clientX, touch.clientY);
            let questionItem = null;
            
            if (elementAtTouch) {
                questionItem = elementAtTouch.closest('.question-item');
            }
            
            // ·∫®n ghost v√† x√≥a l·ªõp dragging
            hideDragGhost();
            draggedItem.classList.remove('dragging');
            
            // X√≥a tr·∫°ng th√°i drag-over t·ª´ t·∫•t c·∫£ c√°c v√πng
            const questionItems = document.querySelectorAll('.question-item');
            questionItems.forEach(item => {
                item.classList.remove('drag-over');
            });
            
            if (questionItem) {
                const answerSlot = questionItem.querySelector('.answer-slot');
                const letter = draggedItem.getAttribute('data-letter');
                
                // LU√îN NH·∫¨N CH·ªÆ C√ÅI (kh√¥ng ki·ªÉm tra ƒë√∫ng/sai ·ªü ƒë√¢y)
                placeLetterInSlot(draggedItem, answerSlot, letter);
            }
            
            draggedItem = null;
        }
        
        // ========== HELPER FUNCTIONS ==========
        
        // T·∫°o ghost element ƒë·ªÉ k√©o theo ng√≥n tay
        function createDragGhost(element, x, y) {
            const letter = element.getAttribute('data-letter');
            const color = 'linear-gradient(145deg, #ffd166, #ffc145)';
            
            dragGhostElement.textContent = letter;
            dragGhostElement.style.background = color;
            dragGhostElement.style.display = 'block';
            dragGhostElement.style.left = x + 'px';
            dragGhostElement.style.top = y + 'px';
            dragGhostElement.style.transform = 'translate(-50%, -50%) scale(1)';
            dragGhostElement.style.opacity = '0.95';
            
            dragGhostVisible = true;
        }
        
        // C·∫≠p nh·∫≠t v·ªã tr√≠ ghost element
        function updateDragGhostPosition(x, y) {
            if (!dragGhostVisible) return;
            
            dragGhostElement.style.left = x + 'px';
            dragGhostElement.style.top = y + 'px';
        }
        
        // ·∫®n ghost element
        function hideDragGhost() {
            dragGhostElement.style.display = 'none';
            dragGhostVisible = false;
        }
        
        // ƒê·∫∑t ch·ªØ c√°i v√†o √¥ tr·ªëng (LU√îN NH·∫¨N)
        function placeLetterInSlot(dragItem, answerSlot, letter) {
            // N·∫øu √¥ ƒë√£ c√≥ ch·ªØ c√°i, tr·∫£ ch·ªØ c√°i ƒë√≥ v·ªÅ (ƒë√°nh d·∫•u kh√¥ng d√πng n·ªØa)
            if (answerSlot.textContent) {
                const currentLetter = answerSlot.textContent;
                // T√¨m keyword c≈© v√† ƒë√°nh d·∫•u kh√¥ng d√πng
                const oldKeyword = document.querySelector(`.keyword-slot.used[data-letter="${currentLetter}"]:not(.dragging)`);
                if (oldKeyword) {
                    oldKeyword.classList.remove('used');
                }
            }
            
            // ƒê·∫∑t ch·ªØ c√°i m·ªõi v√†o √¥ tr·ªëng
            answerSlot.textContent = letter;
            answerSlot.classList.add('filled');
            
            // ƒê√°nh d·∫•u keyword ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng
            dragItem.classList.add('used');
            
            // C·∫≠p nh·∫≠t tr·∫°ng th√°i ARIA
            answerSlot.setAttribute('aria-label', `ƒê√°p √°n: ${letter}`);
            
            // Ph√°t √¢m thanh
            playSound('place');
        }
        
        // Ki·ªÉm tra c√¢u tr·∫£ l·ªùi khi nh·∫•n n√∫t Ki·ªÉm tra
        function checkAnswers() {
            // D·ª´ng b·ªô ƒë·∫øm th·ªùi gian khi ki·ªÉm tra k·∫øt qu·∫£
            stopTimer();
            
            let correctCount = 0;
            let totalCount = 0;
            
            const questionItems = document.querySelectorAll('.question-item');
            questionItems.forEach((item) => {
                const correctAnswer = item.getAttribute('data-correct');
                const answerSlot = item.querySelector('.answer-slot');
                const userAnswer = answerSlot.textContent.toLowerCase();
                
                // Ch·ªâ ƒë·∫øm n·∫øu c√≥ ƒë√°p √°n
                if (userAnswer) {
                    totalCount++;
                    
                    if (userAnswer === correctAnswer) {
                        item.classList.add('correct');
                        item.classList.remove('incorrect');
                        answerSlot.style.background = 'linear-gradient(145deg, #c1ffd7, #a8f5cb)';
                        answerSlot.style.color = '#06a76a';
                        correctCount++;
                    } else {
                        item.classList.add('incorrect');
                        item.classList.remove('correct');
                        answerSlot.style.background = 'linear-gradient(145deg, #ffc9d5, #ffb5c8)';
                        answerSlot.style.color = '#ef476f';
                    }
                }
            });
            
            // Hi·ªÉn th·ªã ph·∫£n h·ªìi
            if (totalCount === 0) {
                feedbackElement.innerHTML = `H√£y k√©o ch·ªØ c√°i v√†o c√°c √¥ tr·ªëng! üëÜ`;
                feedbackElement.className = 'feedback';
                playSound('incorrect');
            } else if (correctCount === totalCount && totalCount === questionItems.length) {
                feedbackElement.innerHTML = `üéâ <strong>Tuy·ªát v·ªùi! ƒê√∫ng h·∫øt!</strong> üéâ<br><small>(${timer.toFixed(1)}s)</small>`;
                feedbackElement.className = 'feedback correct';
                gameCompleted = true;
                playSound('correct');
                
                // Hi·ªáu ·ª©ng ph√°o hoa
                createConfetti();
            } else {
                feedbackElement.innerHTML = `ƒê√∫ng <strong>${correctCount}/${totalCount}</strong>.<br>Th·ª≠ l·∫°i nh√©! üí™`;
                feedbackElement.className = 'feedback incorrect';
                playSound('incorrect');
            }
            
            // C·∫≠p nh·∫≠t ph·∫£n h·ªìi ARIA
            feedbackElement.setAttribute('role', 'alert');
            feedbackElement.setAttribute('aria-live', 'polite');
        }
        
        // T·∫°o hi·ªáu ·ª©ng ph√°o hoa
        function createConfetti() {
            const colors = ['#ff6b6b', '#4a90e2', '#06d6a0, #ffd166', '#9d4edd'];
            
            for (let i = 0; i < 20; i++) {
                const confetti = document.createElement('div');
                confetti.style.position = 'fixed';
                confetti.style.width = '6px';
                confetti.style.height = '6px';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.borderRadius = '50%';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '-10px';
                confetti.style.zIndex = '9999';
                confetti.style.pointerEvents = 'none';
                
                document.body.appendChild(confetti);
                
                // Animation
                const animation = confetti.animate([
                    { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                    { transform: `translateY(${window.innerHeight + 100}px) rotate(${Math.random() * 360}deg)`, opacity: 0 }
                ], {
                    duration: 1000 + Math.random() * 1000,
                    easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
                });
                
                animation.onfinish = () => confetti.remove();
            }
        }
        
        // Ph√°t √¢m thanh
        function playSound(type) {
            if (isMuted) return;
            
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            switch(type) {
                case 'correct':
                    // Chu·ªói n·ªët nh·∫°c vui v·∫ª
                    oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                    oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
                    oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
                    oscillator.frequency.setValueAtTime(1046.50, audioContext.currentTime + 0.3); // C6
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.4);
                    break;
                    
                case 'incorrect':
                    // √Çm thanh ƒë·ªông vi√™n
                    oscillator.frequency.setValueAtTime(392.00, audioContext.currentTime); // G4
                    oscillator.frequency.setValueAtTime(349.23, audioContext.currentTime + 0.1); // F4
                    oscillator.frequency.setValueAtTime(392.00, audioContext.currentTime + 0.2); // G4
                    gainNode.gain.setValueAtTime(0.08, audioContext.currentTime);
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.3);
                    break;
                    
                case 'place':
                    // √Çm thanh khi ƒë·∫∑t ch·ªØ c√°i
                    oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                    gainNode.gain.setValueAtTime(0.06, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.2);
                    break;
            }
        }
        
        // ƒê·∫∑t l·∫°i tr√≤ ch∆°i
        function resetGame() {
            // X√≥a n·ªôi dung c√°c √¥ tr·ªëng
            const answerSlots = document.querySelectorAll('.answer-slot');
            answerSlots.forEach(slot => {
                slot.textContent = '';
                slot.classList.remove('filled');
                slot.style.background = '';
                slot.style.color = '';
                slot.removeAttribute('aria-label');
            });
            
            // X√≥a l·ªõp t·ª´ c√°c c√¢u h·ªèi
            const questionItems = document.querySelectorAll('.question-item');
            questionItems.forEach(item => {
                item.classList.remove('correct', 'incorrect');
            });
            
            // ƒê·∫∑t l·∫°i c√°c keyword
            const keywordSlots = document.querySelectorAll('.keyword-slot');
            keywordSlots.forEach(keyword => {
                keyword.classList.remove('used', 'dragging');
                keyword.style.transition = '';
                keyword.style.transform = '';
            });
            
            // ƒê·∫∑t l·∫°i ph·∫£n h·ªìi
            feedbackElement.textContent = '';
            feedbackElement.className = 'feedback';
            feedbackElement.removeAttribute('role');
            feedbackElement.removeAttribute('aria-live');
            
            // ƒê·∫∑t l·∫°i tr·∫°ng th√°i tr√≤ ch∆°i
            gameCompleted = false;
            
            // ·∫®n ghost n·∫øu ƒëang hi·ªÉn th·ªã
            hideDragGhost();
            
            // Kh·ªüi t·∫°o l·∫°i timer
            startTimer();
        }
        
        // S·ª± ki·ªán cho c√°c n√∫t
        checkBtn.addEventListener('click', checkAnswers);
        resetBtn.addEventListener('click', resetGame);
        
        muteBtn.addEventListener('click', function() {
            isMuted = !isMuted;
            muteBtn.textContent = isMuted ? 'üîà B·∫≠t nh·∫°c' : 'üîá T·∫Øt nh·∫°c';
            muteBtn.setAttribute('aria-pressed', isMuted);
        });
        
        // Th√™m h·ªó tr·ª£ keyboard
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                resetGame();
            } else if (e.key === 'Enter' && document.activeElement === checkBtn) {
                checkAnswers();
            } else if (e.key === 'r' || e.key === 'R') {
                resetBtn.focus();
            } else if (e.key === 'c' || e.key === 'C') {
                checkBtn.focus();
            }
        });
        
        // Th√™m loading state cho h√¨nh ·∫£nh
        document.querySelectorAll('img').forEach(img => {
            img.addEventListener('load', function() {
                this.style.opacity = '1';
            });
            img.style.transition = 'opacity 0.3s';
            img.style.opacity = '0';
        });
        
        // NgƒÉn context menu tr√™n mobile
        document.addEventListener('contextmenu', function(e) {
            if (e.target.classList.contains('keyword-slot')) {
                e.preventDefault();
            }
        });
        
        // Fix height cho mobile browsers
        function setFullHeight() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            const container = document.querySelector('.container');
            if (container) {
                container.style.height = window.innerHeight + 'px';
            }
        }
        
        window.addEventListener('resize', setFullHeight);
        window.addEventListener('orientationchange', setFullHeight);
        setFullHeight();
    </script>
</body>
</html>
